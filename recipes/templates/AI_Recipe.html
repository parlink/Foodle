{% extends "base.html" %}

{% block body %}
<div class="container py-5">

  <h2 class="fw-bold">AI Recipe Generator</h2>
  <h4>List your ingredients and create some recipes!</h4>

  <form method="post" action="{% url 'ai_recipe' %}">
    {% csrf_token %}
    <div class="mt-4">
      <input name="user_input" type="text" class="form-control" placeholder="Chicken,Onions,Lentils">
    </div>

    <div class="d-flex gap-2 mb-4 mt-3">
      <button type="submit" class="btn btn-success" name="submit">Submit</button>
      <button type="submit" class="btn btn-success" name="clear_history">Clear History</button>
    </div>
  </form>

  {% for recipe in recipes %}

    {% if recipe.type == "invalid" %}
      <div class="alert alert-warning p-3 mb-4">
        {{ recipe.text }}
      </div>

    {% elif recipe.type == "recipe" %}

      <div class="gap-2 mb-4">

        <div class="d-flex align-items-center gap-2">
          <h5>{{ recipe.steps.0 }}</h5>

          <form method="post" action="{% url 'ai_recipe' %}">
            {% csrf_token %}
            <input type="hidden" name="save_recipe" value="{{ forloop.counter0 }}">
            <button type="submit" class="btn btn-primary">Save</button>
          </form>
        </div>

        <ul class="list-group list-group-flush">
          {% for step in recipe.steps|slice:"1:-1" %}
            {% if step %}
              <li class="list-group-item">{{ step }}</li>
            {% endif %}
          {% endfor %}
        </ul>

        <h6 class="mt-3">{{ recipe.steps|last }}</h6>

      </div>

    {% endif %}

  {% endfor %}

</div>
{% endblock %}
